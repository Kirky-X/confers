[workspace]
members = ["macros", "temp/api-test", "temp/macro-test"]

[workspace.dependencies]
serde = { version = "1.0", features = ["derive"] }
tokio = { version = "1.0", features = ["full"] }
validator = { version = "0.19", features = ["derive"] }
schemars = "0.8"
thiserror = "2.0"

[package]
name = "confers"
version = "0.1.0"
edition = "2021"
rust-version = "1.75"
authors = ["Kirky.X <kirkyx@outlook.com>"]
license = "MIT"
description = "A modern, type-safe configuration management library with validation, diff, and hot-reload support"
documentation = "https://docs.rs/confers"
homepage = "https://github.com/Kirky-X/confers"
repository = "https://github.com/Kirky-X/confers"
readme = "README.md"
keywords = ["configuration", "config", "type-safe", "serde", "validation"]
categories = ["config", "development-tools", "parser-implementations"]
include = ["src/**", "tests/**", "README.md", "LICENSE-MIT", "LICENSE-APACHE"]

[dependencies]
confers-macros = { path = "macros", version = "0.1.0" }

serde = { workspace = true }
serde_json = "1.0"
toml = "0.8"
serde_yaml = "0.9"
serde_ini = "0.2"

figment = { version = "0.10", features = ["toml", "json", "yaml", "env"] }

clap = { version = "4.5", features = ["derive", "env", "cargo"] }
clap_complete = "4.5"

validator = { workspace = true }

notify = "6.1"
notify-debouncer-full = "0.3"

tokio = { workspace = true }

schemars = { workspace = true }

thiserror = { workspace = true }
anyhow = "1.0"

tracing = "0.1"
tracing-subscriber = "0.3"

dirs = "5.0"
path-absolutize = "3.1"

etcd-client = { version = "0.14", optional = true, features = ["tls"] }
reqwest = { version = "0.11", features = ["json", "rustls-tls", "blocking"], default-features = false, optional = true }

once_cell = "1.20"
lazy_static = "1.5"
shellexpand = "3.1.1"
aes = "0.8.4"
cbc = "0.1.2"
rand = "0.9.2"
base64 = "0.22.1"
pbkdf2 = "0.12.2"
hmac = "0.12.1"
sha2 = "0.10.9"
aes-gcm = "0.10.3"
zeroize = { version = "1.8", features = ["zeroize_derive"] }
lru = "0.12"
url = "2.5.7"
failsafe = { version = "1.3.0", optional = true }
rustls = { version = "0.23", default-features = false, features = ["ring", "logging", "std", "tls12"] }
rustls-pki-types = { version = "1.13.2", optional = true }
tokio-rustls = { version = "0.26.4", default-features = false, features = ["ring", "logging", "tls12"], optional = true }
regex = "1.10"
humantime = "2.1"
sysinfo = "0.33"
chrono = { version = "0.4", features = ["serde"] }

jsonschema = { version = "0.28", optional = true }
rayon = { version = "1.10", optional = true }
num_cpus = "1.16"

[dev-dependencies]
tempfile = "3.10"
assert_cmd = "2.0"
predicates = "3.1"
temp-env = "0.3"
mockall = "0.12"
wiremock = "0.6"
warp = "0.3"
cargo-tarpaulin = "0.27"

[features]
default = []
watch = []
audit = []
schema = ["dep:jsonschema"]
parallel = ["dep:rayon"]
remote = ["dep:etcd-client", "dep:reqwest", "dep:failsafe", "dep:rustls-pki-types", "dep:tokio-rustls"]
failsafe = ["dep:failsafe"]
rustls-pki-types = ["dep:rustls-pki-types"]
tokio-rustls = ["dep:tokio-rustls"]
